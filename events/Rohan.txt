###########################
# Rohan Events
###########################

add_namespace = rohan

# Saruman Demands the Westmarch
country_event = {
	id = rohan.5
	title = rohan.5.t
	desc = rohan.5.d
	picture = GFX_report_event_orcs_marching

	is_triggered_only = yes

	option = { # Accept
		name = rohan.5.a
		ai_chance = {
			base = 50
			modifier = {
				add = 30
				NOT = { ROH = { has_government = cooperative } }
			}
			modifier = {
				add = -25
				ISE = { has_army_size = { size < 30 } }
			}
			modifier = {
				add = 30
				ISE = { has_army_size = { size > 45 } }
			}
		}
 		ISE = {country_event = { hours = 2 id = isengard.2 } }
	}
	option = { # Refuse
		name = rohan.5.b
		ai_chance = {
			base = 50
		}
		ISE = {country_event = { hours = 2 id = isengard.3 } }
	}
}

# Gandalf arrives in Rohan
country_event = {
	id = rohan.6
	title = rohan.6.t
	desc = rohan.6.d
	picture = GFX_report_event_ring

	fire_only_once = yes

	trigger = {
		tag = ROH
		OR = {
			AND = {
				has_global_flag = fs_gandalf_left_fellowship
				date > 3020.1.1
			}
			# If the fellowship moves south past isengard, Gandalf can take a pit-stop at Rohan lol
			AND = {
				check_variable = { global.fs_currentstate = 26 }
				ring_gandalf_in_fellowship = yes
			}
			has_global_flag = fs_ring_seized
			date > 3022.1.1 # This is here as a stop-gap measure. If gandalf is bugged for some reason, this will keep Rohan remotely playable
		}
	}

	mean_time_to_happen = {
		days = 30
	}

	option = { # Let him in
		name = rohan.6.a
		ai_chance = {
			base = 250
			modifier = { factor = 0 is_going_cooperative = no }
		}
 		set_global_flag = gandalf_allowed_into_rohan
	}
	option = { # Deny Access
		name = rohan.6.b
		ai_chance = {
			base = 100
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
			modifier = { factor = 0 is_going_belligerent = no }
		}
		set_global_flag = gandalf_denied_access_rohan
	}
}

# Theodred dies
country_event = {
	id = rohan.4
	title = rohan.4.t
	desc = rohan.4.d
	picture = GFX_report_event_paper

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = rohan.4.a
		retire_character = ROH_theodred
		hidden_effect = {news_event = { hours = 48 id = news.336 }}
	}

}

# Grima Wormtongue hired as chief advisor
country_event = {
	id = rohan.1
	title = rohan.1.t
	desc = rohan.1.d
	picture = GFX_report_event_paper

	fire_only_once = yes

	trigger = {
		tag = ROH
		date > 3018.9.1
	}

	mean_time_to_happen = {
		days = 30
	}

	option = {
		name = rohan.1.a
		hire_grima_wormtongue = yes
	}

}


# King Theoden becomes ill
country_event = {
	id = rohan.2
	title = rohan.2.t
	desc = rohan.2.d
	picture = GFX_report_event_paper

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = rohan.2.a
		set_politics = { ruling_party = unaligned elections_allowed = no }
		ROH_theoden = { remove_unit_leader = yes }
		hidden_effect = { news_event = { hours = 48 id = news.337 } }
	}

}


# Eomer goes into exile
country_event = {
	id = rohan.3
	title = rohan.3.t
	desc = rohan.3.d
	picture = GFX_report_event_paper

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = rohan.3.a

		add_manpower = -20000
		ROH_eomer = {
			remove_unit_leader = yes
			remove_advisor_role = {
				slot = chief_advisor
			}
		}
	}

}


# Event for Grima Eowyn marriage
country_event = {
	id = rohan.7
	title = rohan.7.t
	desc = rohan.7.d
	picture = GFX_report_event_paper

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = rohan.7.a
		set_global_flag = grima_eowyn_married
		hidden_effect = { news_event = { hours = 48 id = news.338 } }
	}
}

# Event for Gondor sending help to deal with Isengard
country_event = {
	id = rohan.8
	title = rohan.8.t
	desc = rohan.8.d
	picture = GFX_report_event_paper

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = rohan.8.a
		add_manpower = 10000
		add_equipment_to_stockpile = {
			type = infantry_equipment_0
			amount = 1000
		}
		add_opinion_modifier = { target = GON modifier = medium_increase }
	}
}

#Arthedain suggestes research sharing agremeent
country_event = {
	id = rohan.9
	title = rohan.9.t
	desc = rohan.9.d
	picture = GFX_report_event_generic_reading

	is_triggered_only = yes

	option = { #Yes
		name = rohan.9.a
		ai_chance = {
			base = 25
			modifier = {
				add = 500
				is_in_faction_with = ART
			}
			modifier = {
				add = 20
				has_opinion = { target = ART value > 50 }
			}
			modifier = {
				add = 5
				has_government = cooperative
				ART = {
					has_government = cooperative
				}
			}
			modifier = {
				add = -10
				has_government = cooperative
				ART = {
					OR = {
						has_government = belligerent
						has_government = revolutionary
					}
				}
			}
		}
		add_opinion_modifier = { target = ART modifier = small_increase }
		army_experience = 10
		add_political_power = 50
		add_tech_bonus = {
			name = industrial_bonus
			bonus = 0.5
			uses = 1
			category = lotr_men_secrets_rangers
		}
		ART = {
			country_event = { id = arthedain.23 }
			event_option_tooltip = arthedain.23.a
		}
	}
	option = { #No
		name = rohan.9.b
		ai_chance = {
			base = 25
			modifier = {
				add = 25
				has_opinion = { target = ART value < 0 }
			}
			modifier = {
				add = 10
				has_government = cooperative
				NOT = { ART = { has_government = cooperative } }
			}
		}
		ART = {
			add_opinion_modifier = { target = ROH modifier = small_decrease }
			country_event = { id = arthedain.11 }
		}
	}
}

# Grima Wormtongue doing stuff
country_event = {
	id = rohan.10

	hidden = yes

	trigger = {
		original_tag = ROH
		has_idea = ROH_grima
	}

	mean_time_to_happen = {
		days = 1
	}

	immediate = {
		random_list = {
			10 = {
				# hire an advisor
				grima_hire_advisor = yes
			}
			10 = {
				# promote someone on his side ???
				grima_banish_rival = yes
			}
			10 = {
				# fuck around with lords
				grima_replace_horselord = yes
			}
			10 = {
				# random shit
				grima_misc_actions = yes
			}
		}
	}
}

# Getting rid of Theoden "manually"
country_event = {
	id = rohan.11
	title = rohan.11.t
	desc = rohan.11.d
	picture = GFX_report_event_paper

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = rohan.11.a
		#TODO
	}
}

# Getting rid of Eomer "manually"
country_event = {
	id = rohan.12
	title = rohan.12.t
	desc = rohan.12.d
	picture = GFX_report_event_paper

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = rohan.12.a
		# TODO
	}
}






# chief advisor
country_event = {
	id = rohan.51
	title = rohan.51.t
	desc = rohan.51.d

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = rohan.51.a
		add_ideas = ROH_leocred
	}
}

# spymaster
country_event = {
	id = rohan.52
	title = rohan.52.t
	desc = rohan.52.d

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = rohan.52.a
		add_ideas = ROH_fengel
	}
}

# treasurer
country_event = {
	id = rohan.53
	title = rohan.53.t
	desc = rohan.53.d

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = rohan.53.a
		add_ideas = ROH_heostor
	}
}

# advisor
country_event = {
	id = rohan.54
	title = rohan.54.t
	desc = rohan.54.d

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = rohan.54.a
		add_ideas = ROH_widgelred
	}
}

# advsior
country_event = {
	id = rohan.55
	title = rohan.55.t
	desc = rohan.55.d

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = rohan.55.a
		add_ideas = ROH_frumbold
	}
}

# chief researcher
country_event = {
	id = rohan.56
	title = rohan.56.t
	desc = rohan.56.d

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = rohan.56.a
		add_ideas = shady_intellectual_idea_ROH
	}
}

# architect
country_event = {
	id = rohan.57
	title = rohan.57.t
	desc = rohan.57.d

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = rohan.57.a
		add_ideas = luxury_powerbroker_idea_ROH
	}
}

# theorist
country_event = {
	id = rohan.58
	title = rohan.58.t
	desc = rohan.58.d

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = rohan.58.a
		add_ideas = ROH_grimbeam
	}
}

# researcher
country_event = {
	id = rohan.59
	title = rohan.59.t
	desc = rohan.59.d

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = rohan.59.a
		add_ideas = backroom_beneficiary_idea_ROH
	}
}

# researcher
country_event = {
	id = rohan.60
	title = rohan.60.t
	desc = rohan.60.d

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = rohan.60.a
		add_ideas = rampant_plagiarizer_wrm_idea_ROH
	}
}

# army chief
country_event = {
	id = rohan.61
	title = rohan.61.t
	desc = rohan.61.d

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = rohan.61.a
		add_ideas = ROH_erkenor
	}
}

# navy chief
country_event = {
	id = rohan.62
	title = rohan.62.t
	desc = rohan.62.d

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = rohan.62.a
		add_ideas = ROH_freca
	}
}

# cavalry chief
country_event = {
	id = rohan.63
	title = rohan.63.t
	desc = rohan.63.d

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = rohan.63.a
		add_ideas = ROH_heoere
	}
}

# high command
country_event = {
	id = rohan.64
	title = rohan.64.t
	desc = rohan.64.d

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = rohan.64.a
		add_ideas = ROH_herethain
	}
}

# high command
country_event = {
	id = rohan.65
	title = rohan.65.t
	desc = rohan.65.d

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = rohan.65.a
		add_ideas = ROH_leoheort
	}
}

# Grima promotes new commander
country_event = {
	id = rohan.66
	title = rohan.66.t
	desc = rohan.66.d
	picture = GFX_report_event_army_camp

	is_triggered_only = yes

	option = {
		name = rohan.66.a

		move_bop_to_grima = yes
		custom_effect_tooltip = rohan.66.a_tt
		hidden_effect = {
			random_list = {
				100 = {
					modifier = {
						factor = 0
						ROH_theobold = { is_unit_leader = yes }
					}
					add_corps_commander_role = {
						Character = ROH_theobold
						traits = { wormtongue_sympathizer trait_reckless }
						skill = 4
						attack_skill = 5
						defense_skill = 3
						planning_skill = 1
						logistics_skill = 2
					}
				}
				100 = {
					modifier = {
						factor = 0
						ROH_leodig = { is_unit_leader = yes }
					}
					add_corps_commander_role = {
						Character = ROH_leodig
						traits = { wormtongue_sympathizer trait_cautious politically_connected }
						skill = 3
						attack_skill = 2
						defense_skill = 3
						planning_skill = 3
						logistics_skill = 2
					}
				}
				100 = {
					modifier = {
						factor = 0
						ROH_gleotor = { is_unit_leader = yes }
					}
					add_corps_commander_role = {
						Character = ROH_gleotor
						traits = { wormtongue_sympathizer politically_connected }
						skill = 3
						attack_skill = 3
						defense_skill = 1
						planning_skill = 2
						logistics_skill = 3
					}
				}
				1 = {

				}
			}
		}
	}
}

# Grima banishes eorl loyalist commander
country_event = {
	id = rohan.67
	title = rohan.67.t
	desc = rohan.67.d
	picture = GFX_report_event_exile

	is_triggered_only = yes

	option = {
		name = rohan.67.a

		move_bop_to_grima = yes
		random_unit_leader = {
			limit = { has_trait = eorl_loyalist }
			retire = yes
		}
	}
}

# Grima crushes peasant unrest
country_event = {
	id = rohan.68
	title = rohan.68.t
	desc = rohan.68.d
	picture = GFX_report_event_peasant_revolt3

	is_triggered_only = yes

	option = {
		name = rohan.68.a

		move_bop_to_grima = yes
		add_manpower = -50
		add_stability = 0.05
	}
}

# Grima rallies military support
country_event = {
	id = rohan.69
	title = rohan.69.t
	desc = rohan.69.d
	picture = GFX_report_event_cavalry_knights

	is_triggered_only = yes

	option = {
		name = rohan.69.a

		move_bop_to_grima = yes
		add_war_support = 0.05
	}
}

# Grima increases trading tolls
country_event = {
	id = rohan.70
	title = rohan.70.t
	desc = rohan.70.d
	picture = GFX_report_event_horseman_wanderer

	is_triggered_only = yes

	option = {
		name = rohan.70.a

		move_bop_to_grima = yes
		add_timed_idea = {
			idea = increased_trading_tolls
			days = 175
		}
	}
}

# Grima convenes with king
country_event = {
	id = rohan.71
	title = rohan.71.t
	desc = rohan.71.d
	picture = GFX_report_event_grima

	is_triggered_only = yes

	option = {
		name = rohan.71.a

		move_bop_to_grima = yes
		add_popularity = {
			ideology = belligerent
			popularity = 0.05
		}
		add_political_power = 50
	}
}

# Grima raises new levy army
country_event = {
	id = rohan.72
	title = rohan.72.t
	desc = rohan.72.d
	picture = GFX_report_event_army_camp

	is_triggered_only = yes

	option = {
		name = rohan.72.a

		move_bop_to_grima = yes
		add_manpower = 10000
	}
}

# Grima makes concessions to Isengard
country_event = {
	id = rohan.73
	title = rohan.73.t
	desc = rohan.73.d
	picture = GFX_report_event_grima_saruman

	is_triggered_only = yes

	option = {
		name = rohan.73.a

		move_bop_to_grima = yes
		add_political_power = 50
		ISE = {
			add_collaboration = {
				target = ROH
				value = 0.1
			}
		}
	}
}

# Isengard gearing up to attack fellowship. Help?
country_event = {
	id = rohan.74
	title = rohan.74.t
	desc = rohan.74.d
	picture = GFX_report_event_paper

	fire_only_once = yes

	timeout_days = 7

	is_triggered_only = yes

	option = {
		name = rohan.74.a

		set_country_flag = fs_rohan_coordinating_with_isengard

		custom_effect_tooltip = rohan.74.a_tt

		hidden_effect = { ISE = { country_event = { id = isengard.7 days = 3 } } }
	}

	option = {
		name = rohan.74.b

		hidden_effect = { ISE = { country_event = { id = isengard.7 days = 3 } } }
	}

}