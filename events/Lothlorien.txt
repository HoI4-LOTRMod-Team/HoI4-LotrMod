###########################
# Lorien Events
###########################

add_namespace = lothlorien


# Lorien asks jo join Gondor Faction
country_event = {
	id = lothlorien.1
	title = lothlorien.1.t
	desc = lothlorien.1.d
	picture = GFX_report_event_alliance
	
	is_triggered_only = yes
	
	option = { #Accept
		name = lothlorien.1.a
		ai_chance = {
			base = 60
			modifier = {
				add = 40
				GON = { has_war = yes }
			}
		}
		GON = { add_to_faction = LTH }
	}
	option = { #Refuse
		name = lothlorien.1.b
		ai_chance = {
			base = 30
			modifier = {
				add = 5000
				GON = { has_government = belligerent }
			}
			modifier = {
				add = 20
				GON = { has_government = unaligned }
			}
			modifier = {
				add = 10
				LTH = { has_war = yes }
			}
		}
	}
}

# Offer shelter to fellowship
country_event = {
	id = lothlorien.3
	title = lothlorien.3.t
	desc = lothlorien.3.d
	fire_only_once = yes

	is_triggered_only = yes

	option = {
		ai_chance = {base = 6}
		name = lothlorien.3.a

		ring_rivendell_approves = yes

		set_global_flag = LTH_offered_shelter
		LTH = {complete_national_focus = offersheltertothefellowship}

		# delay the fellowship leaving
		add_to_variable = { global.fs_days_left_in_state = 30 }

		# give choice to take the ring after a while
		hidden_effect = {
			LTH = { country_event = { days = 7 id = lothlorien.2 } }

			ring_heal_fellowship = yes

			add_to_array = { global.fs_eventlog_prefix_targets = 0 }
			add_to_array = { global.fs_eventlog_suffix_targets = 0 }
			add_to_array = { global.fs_eventlog = token:fs_event_lth_give_shelter }
			ring_trim_eventlog = yes
		}
	}
	option = {
		ai_chance = {
			base = 1 
			modifier = {is_historical_focus_on = yes factor = 0}
		}
		name = lothlorien.3.b

		ring_rivendell_disapproves = yes

		hidden_effect = {
			add_to_array = { global.fs_eventlog_prefix_targets = 0 }
			add_to_array = { global.fs_eventlog_suffix_targets = 0 }
			add_to_array = { global.fs_eventlog = token:fs_event_lth_refuse_shelter }
			ring_trim_eventlog = yes
		}
	}
}

# Take ring?
country_event = {
	id = lothlorien.2
	title = lothlorien.2.t
	desc = lothlorien.2.d
	fire_only_once = yes
	picture = GFX_report_event_ring
	
	is_triggered_only = yes

	# take it
	option = {
		name = lothlorien.2.a
		ai_chance = {
			base = 3
			modifier = {
				OR = {
					has_completed_focus = victorythroughstrength
					has_completed_focus = victorythroughsubmission
					has_completed_focus = victorythroughequity
				}
				add = 10
			}
			modifier = { is_historical_focus_on = yes factor = 0 }
		}

		ring_rivendell_disapproves = yes

		add_political_power = -250

		LTH = {complete_national_focus = taketheringfromfrodo}

		random_list = {

			# Frodo offers the ring up willingly
			5 = {
				LTH = { country_event = { days = 7 id = lothlorien.4 } }
			}
			# Frodo refuses
			95 = {
				LTH = { country_event = { days = 7 id = lothlorien.5 } }
			}
		}

		custom_effect_tooltip = lothlorien.2.a.tt
	}
	# dont
	option = {
		name = lothlorien.2.b # gear up fellowship
		ai_chance = {
			base = 5
		}

		ring_rivendell_approves = yes
		
		LTH = { country_event = { days = 7 id = lothlorien.6 } }
	}
	
}

# Frodo gives ring
country_event = {
	id = lothlorien.4
	title = lothlorien.4.t
	desc = lothlorien.4.d
	fire_only_once = yes

	is_triggered_only = yes

	option = {
		ai_chance = { base = 1 }
		name = lothlorien.4.a

		hidden_effect = {
			news_event = { hours = 12 id = news.371 }
			ring_seize_ring = yes

			add_to_array = { global.fs_eventlog_prefix_targets = 0 }
			add_to_array = { global.fs_eventlog_suffix_targets = 0 }
			add_to_array = { global.fs_eventlog = token:fs_event_lth_frodo_gives_ring }
			ring_trim_eventlog = yes
		}
	}
}

# Frodo refuses
country_event = {
	id = lothlorien.5
	title = lothlorien.5.t
	desc = lothlorien.5.d
	fire_only_once = yes

	is_triggered_only = yes

	# Escalate
	option = {
		ai_chance = {
			base = 1
			modifier = {
				OR = {
					has_completed_focus = victorythroughstrength
					has_completed_focus = victorythroughsubmission
					has_completed_focus = victorythroughequity
				}
				add = 10
			}
		}
		name = lothlorien.5.a

		custom_effect_tooltip = lothlorien.5.a.tt

		ring_rivendell_disapproves = yes

		hidden_effect = {
			add_to_array = { global.fs_eventlog_prefix_targets = 0 }
			add_to_array = { global.fs_eventlog_suffix_targets = 0 }
			add_to_array = { global.fs_eventlog = token:fs_event_lth_frodo_refuses }
			ring_trim_eventlog = yes

			add_to_array = { global.fs_eventlog_prefix_targets = 0 }
			add_to_array = { global.fs_eventlog_suffix_targets = 0 }
			add_to_array = { global.fs_eventlog = token:fs_event_lth_frodo_refuses_escalate }
			ring_trim_eventlog = yes

			ring_open_interception_attempt_prompt = yes
		}
	}
	# Doesnt matter
	option = {
		ai_chance = { base = 2 }
		name = lothlorien.5.b

		custom_effect_tooltip = lothlorien.5.b.tt

		ring_rivendell_approves = yes

		hidden_effect = {
			add_to_array = { global.fs_eventlog_prefix_targets = 0 }
			add_to_array = { global.fs_eventlog_suffix_targets = 0 }
			add_to_array = { global.fs_eventlog = token:fs_event_lth_frodo_refuses }
			ring_trim_eventlog = yes
		}

		LTH = { country_event = { days = 2 id = lothlorien.6 } }
	}
}

# Gear up fellowship
country_event = {
	id = lothlorien.6
	title = lothlorien.6.t
	desc = lothlorien.6.d
	fire_only_once = yes

	is_triggered_only = yes

	# Gifts
	option = {
		ai_chance = {
			base = 1
		}
		name = lothlorien.6.a

		custom_effect_tooltip = lothlorien.6.a.tt

		add_timed_idea = {
    		idea = minor_expense
    		days = 180
		}

		hidden_effect = {
			# Increase attack level of all by 1
			SHI = {
				for_each_scope_loop = {
					array = global.fs_members

					THIS = { add_attack = 1 }
				}
			}

			add_to_array = { global.fs_eventlog_prefix_targets = 0 }
			add_to_array = { global.fs_eventlog_suffix_targets = 0 }
			add_to_array = { global.fs_eventlog = token:fs_event_lth_gifts }
			ring_trim_eventlog = yes
		}
	}

	# Haldir
	option = {
		ai_chance = {
			base = 1
			modifier = { is_historical_focus_on = yes factor = 0 }
		}
		name = lothlorien.6.b

		custom_effect_tooltip = lothlorien.6.b.tt

		LTH_haldir = { retire = yes }
		hidden_effect = {
			add_to_array = { global.fs_eventlog_prefix_targets = 0 }
			add_to_array = { global.fs_eventlog_suffix_targets = 0 }
			add_to_array = { global.fs_eventlog = token:fs_event_lth_haldir }
			ring_trim_eventlog = yes

			SHI = { FS_haldir = { ring_add_member_to_fellowship = yes } }
		}
	}

	# Nothing
	option = {
		ai_chance = {
			base = 1
			modifier = { is_historical_focus_on = yes factor = 0 }
		}
		name = lothlorien.6.c

		ring_rivendell_disapproves = yes
	}
}

# Schism: Public Celebrations
country_event = {
	id = lothlorien.7
	title = lothlorien.7.t
	desc = lothlorien.7.d
	fire_only_once = yes

	is_triggered_only = yes

	# Have Gala give a speech
	option = {
		ai_chance = {
			base = 1
		}
		name = lothlorien.7.a

		# TODO
	}

	# Have Cele give a speech
	option = {
		ai_chance = {
			base = 1
		}
		name = lothlorien.7.b

		# TODO
	}

	# Pick out a random person
	option = {
		ai_chance = {
			base = 1
		}
		name = lothlorien.7.c

		# TODO
	}

	# No speeches
	option = {
		ai_chance = {
			base = 1
		}
		name = lothlorien.7.d

		# TODO
	}
}

# Schism: Consult elves
country_event = {
	id = lothlorien.8
	title = lothlorien.8.t
	desc = lothlorien.8.d
	fire_only_once = yes

	is_triggered_only = yes

	# Support Gala
	option = {
		ai_chance = {
			base = 1
		}
		name = lothlorien.8.a

		# TODO
	}

	# Support Cele
	option = {
		ai_chance = {
			base = 1
		}
		name = lothlorien.8.b

		# TODO
	}

	# Abstain
	option = {
		ai_chance = {
			base = 1
		}
		name = lothlorien.8.c

		# TODO
	}
}

# Aid to Helm's deep
country_event = {
	id = lothlorien.9
	title = lothlorien.9.t
	desc = lothlorien.9.d
	fire_only_once = yes

	is_triggered_only = yes

	# Thanks
	option = {
		ai_chance = {
			base = 1
		}
		name = lothlorien.9.a

		# TODO
	}
}

# Aid to Minas Tirith
country_event = {
	id = lothlorien.10
	title = lothlorien.10.t
	desc = lothlorien.10.d
	fire_only_once = yes

	is_triggered_only = yes

	# Thanks
	option = {
		ai_chance = {
			base = 1
		}
		name = lothlorien.10.a

		# TODO
	}
}

# Commemorate Gondolin
country_event = {
	id = lothlorien.11
	title = lothlorien.11.t
	desc = lothlorien.11.d
	fire_only_once = yes

	is_triggered_only = yes

	# As an epic battle
	option = {
		ai_chance = {
			base = 1
		}
		name = lothlorien.11.a

		# Increase attack and breakthrough bonus by 5%
	}

	# As a tragedy to be rebuilt
	option = {
		ai_chance = {
			base = 1
		}
		name = lothlorien.11.b

		# Increase factory output bonus by 10%
	}
}

